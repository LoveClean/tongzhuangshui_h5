(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/order_list/order_list_temp"],{6025:function(t,e,s){"use strict";s.r(e);var o=s("9572"),i=s.n(o);for(var n in o)"default"!==n&&function(t){s.d(e,t,function(){return o[t]})}(n);e["default"]=i.a},7360:function(t,e,s){"use strict";s("4436");var o=n(s("b0ce")),i=n(s("a65f"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,o.default)(i.default))},"751a":function(t,e,s){"use strict";var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",[s("view",{staticClass:"topTabBar",style:{position:t.headerPosition,top:t.headerTop}},t._l(t.orderType,function(e,o){return s("view",{key:o,staticClass:"grid",attrs:{eventid:"45d01578-0-"+o},on:{tap:function(e){t.showType(o)}}},[s("view",{staticClass:"text",class:[o==t.tabbarIndex?"on":""]},[t._v(t._s(e))])])})),s("view",{staticClass:"order-list"},[s("view",{staticClass:"list"},[0==t.list.length?s("view",{staticClass:"onorder"},[s("image",{attrs:{src:"../../../static/img/noorder.png"}}),s("view",{staticClass:"text"},[t._v("没有相关订单")])]):t._e(),t._l(t.list,function(e,o){return s("view",{key:o,staticClass:"row"},[s("view",{staticClass:"type"},[s("view",{staticClass:"left"},[t._v(t._s(e.createDate))]),s("view",{staticClass:"right"},[t._v(t._s(t.typeText[e.type]))])]),t._l(e.orderDetailModels,function(e,o){return s("view",{key:o,staticClass:"order-info"},[s("view",{staticClass:"left"},[s("image",{attrs:{src:e.cover}})]),s("view",{staticClass:"right"},[s("view",{staticClass:"name"},[t._v(t._s(e.productName))]),s("view",{staticClass:"spec"},[t._v(t._s(e.introduction))]),s("view",{staticClass:"price-number"},[t._v("￥"),s("view",{staticClass:"price"},[t._v(t._s(e.price))]),t._v("x"),s("view",{staticClass:"number"},[t._v(t._s(e.quantity))])])])])}),s("view",{staticClass:"detail"},[e.orderDetailModels?s("view",{staticClass:"number"},[t._v("共"+t._s(e.orderDetailModels.length)+"类商品")]):t._e(),s("view",{staticClass:"sum"},[t._v("合计￥"),s("view",{staticClass:"price"},[t._v(t._s(e.payableAmount))])]),e.couponsAmount>0?s("view",{staticClass:"nominal"},[t._v("(已优惠 ￥"+t._s(e.couponsAmount)+")")]):t._e()]),s("view",{staticClass:"btns"},["unpaid"==e.type?s("block",[s("view",{staticClass:"default",attrs:{eventid:"45d01578-1-"+o},on:{tap:function(s){t.changeType(e.id,"unpaid")}}},[t._v("取消订单")]),s("view",{staticClass:"pay",attrs:{eventid:"45d01578-2-"+o},on:{tap:function(s){t.payment(e)}}},[t._v("付款")])]):t._e(),"back"==e.type?s("block",[s("view",{staticClass:"default",attrs:{eventid:"45d01578-3-"+o},on:{tap:function(s){t.changeType(e.id,"back")}}},[t._v("取消订单")])]):t._e(),"unreceived"==e.type?s("block",[s("view",{staticClass:"default",attrs:{eventid:"45d01578-4-"+o},on:{tap:function(s){t.toCall(e.shopContact)}}},[t._v("联系商家")]),s("view",{staticClass:"pay",attrs:{eventid:"45d01578-5-"+o},on:{tap:function(s){t.changeType(e.id,"unreceived")}}},[t._v("确认收货")])]):t._e(),"completed"==e.type?s("block",[s("view",{staticClass:"default",attrs:{eventid:"45d01578-6-"+o},on:{tap:function(s){t.toConfirmation(e)}}},[t._v("再次购买")])]):t._e(),"refunds"==e.type?s("block",[s("view",{staticClass:"default",attrs:{eventid:"45d01578-7-"+o},on:{tap:function(s){t.toConfirmation(e)}}},[t._v("重新下单")])]):t._e()],1)],2)})],2)])])},i=[];s.d(e,"a",function(){return o}),s.d(e,"b",function(){return i})},9572:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={data:function(){return{headerPosition:"fixed",headerTop:"0px",typeText:{unpaid:"等待付款",back:"等待商家发货",unreceived:"商家正在配送",completed:"交易已完成",refunds:"订单已取消"},orderType:["全部","待付款","待发货","待收货","已完成","已取消"],orderList:[[],[],[],[],[],[]],list:[],tabbarIndex:0}},onLoad:function(e){t.showLoading({title:"加载中"}),console.log("option: "+JSON.stringify(e));var s=parseInt(e.tbIndex)+1;this.tabbarIndex=s,console.log(s),this.showType(s)},onPageScroll:function(t){},methods:{refreshList:function(e){var s=this;t.request({url:this.$tempUrl+"buyer/order/listByStatus",method:"GET",data:{openId:t.getStorageSync("openId"),status:e-1},success:function(t){s.orderList[e]=t.data.data,s.list=s.orderList[e]}})},refreshListOther:function(e){var s=this;t.request({url:this.$tempUrl+"buyer/order/listByStatus",method:"GET",data:{openId:t.getStorageSync("openId"),status:e-1},success:function(t){s.orderList[e]=t.data.data}})},showType:function(e){var s=this;this.tabbarIndex=e,0===this.orderList[e].length?t.request({url:this.$tempUrl+"buyer/order/listByStatus",method:"GET",data:{openId:t.getStorageSync("openId"),status:e-1},success:function(o){s.orderList[e]=o.data.data,s.list=s.orderList[e],setTimeout(function(){t.hideLoading()},100)}}):this.list=this.orderList[e]},changeType:function(e,s){var o=this;console.log(e),"unpaid"===s?t.showModal({title:"提示",content:"取消此订单？",success:function(s){s.confirm?(console.log("用户点击确定"),t.request({url:o.$tempUrl+"buyer/order/cancel",method:"POST",data:{openId:t.getStorageSync("openId"),orderId:e},success:function(e){0===e.data.code?(t.showToast({title:"订单已取消",icon:"success"}),o.refreshList(1),o.refreshListOther(5),o.refreshListOther(0)):(t.showModal({title:"提示",content:"订单取消失败",showCancel:!1}),o.refreshList(1),o.refreshListOther(0))}})):s.cancel&&console.log("用户点击取消")}}):"back"===s?t.showModal({title:"提示",content:"取消此订单？",success:function(s){s.confirm?(console.log("用户点击确定"),t.request({url:o.$tempUrl+"buyer/order/cancel",method:"POST",data:{openId:t.getStorageSync("openId"),orderId:e},success:function(e){0===e.data.code?(t.showToast({title:"订单已取消",icon:"success"}),o.refreshList(2),o.refreshListOther(5),o.refreshListOther(0)):(t.showModal({title:"提示",content:"商家已接单，订单取消失败",showCancel:!1}),o.refreshList(2),o.refreshListOther(3),o.refreshListOther(0))}})):s.cancel&&console.log("用户点击取消")}}):"unreceived"===s&&t.showModal({title:"提示",content:"完结此订单？",success:function(s){s.confirm?(console.log("用户点击确定"),t.request({url:o.$tempUrl+"buyer/order/finish",method:"POST",data:{openId:t.getStorageSync("openId"),orderId:e},success:function(e){0===e.data.code?(t.showToast({title:"订单已完结",icon:"success"}),o.refreshList(3),o.refreshListOther(4),o.refreshListOther(0)):(t.showModal({title:"提示",content:"订单完结失败",showCancel:!1}),o.refreshList(3),o.refreshListOther(0))}})):s.cancel&&console.log("用户点击取消")}})},toConfirmation:function(e){t.setStorageSync("shopId",e.shopId),t.setStorage({key:"buylist",data:e.orderDetailModels,success:function(){t.navigateTo({url:"../../order/confirmation"})}})},toCall:function(e){t.makePhoneCall({phoneNumber:e})},payment:function(e){var s=this;t.showModal({title:"支付",content:"确认支付￥"+e.payableAmount,success:function(o){o.confirm?t.request({url:s.$tempUrl+"buyer/order/paid",method:"POST",data:{openId:t.getStorageSync("openId"),orderId:e.id},success:function(e){0===e.data.code?(t.showToast({title:"支付成功",icon:"success"}),s.refreshList(1),s.refreshListOther(2),s.refreshListOther(0)):(t.showModal({title:"提示",content:"订单异常，支付失败",showCancel:!1}),s.refreshList(1),s.refreshListOther(0))}}):o.cancel&&t.showToast({title:"支付已取消，请尽快完成付款",icon:"none"})}})}}};e.default=s}).call(this,s("543d")["default"])},a65f:function(t,e,s){"use strict";s.r(e);var o=s("751a"),i=s("6025");for(var n in i)"default"!==n&&function(t){s.d(e,t,function(){return i[t]})}(n);s("f6b1");var a=s("2877"),r=Object(a["a"])(i["default"],o["a"],o["b"],!1,null,null,null);e["default"]=r.exports},f6b1:function(t,e,s){"use strict";var o=s("f6d3"),i=s.n(o);i.a},f6d3:function(t,e,s){}},[["7360","common/runtime","common/vendor"]]]);