(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/confirmation"],{"7ba1":function(t,e,a){"use strict";a.r(e);var s=a("a0fa"),i=a("c45d");for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);a("f8bf");var r=a("2877"),c=Object(r["a"])(i["default"],s["a"],s["b"],!1,null,null,null);e["default"]=c.exports},"8d43":function(t,e,a){},a0fa:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",[a("view",{staticClass:"addr",attrs:{eventid:"abfeaab4-0"},on:{tap:t.changeAddr}},[t._m(0),a("view",{staticClass:"right"},[a("view",{staticClass:"tel-name"},[a("view",{staticClass:"name"},[t._v(t._s(t.addrMain.contactName))]),a("view",{staticClass:"tel"},[t._v(t._s(t.addrMain.contactPhone))])]),t.addrMain.area?a("view",{staticClass:"addres"},[t._v(t._s(t.addrMain.area.label)+"-"+t._s(t.addrMain.address))]):t._e(),t.addrMain.areaName?a("view",{staticClass:"addres"},[t._v(t._s(t.addrMain.areaName)+"-"+t._s(t.addrMain.address))]):t._e()])]),a("view",{staticClass:"buy-list"},t._l(t.buylist,function(e,s){return a("view",{key:s,staticClass:"row"},[a("view",{staticClass:"goods-info"},[a("view",{staticClass:"img"},[a("image",{attrs:{src:e.cover}})]),a("view",{staticClass:"info"},[a("view",{staticClass:"title"},[t._v(t._s(e.name))]),a("view",{staticClass:"spec"},[t._v(t._s(e.promotion)+" 数量:"+t._s(e.stock))]),a("view",{staticClass:"price-number"},[a("view",{staticClass:"price"},[t._v("￥"+t._s(e.price*e.stock))]),a("view",{staticClass:"number"})])])])])})),a("view",{staticClass:"order"},[a("view",{staticClass:"row"},[a("view",{staticClass:"left"},[t._v("备注 :")]),a("view",{staticClass:"right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.note,expression:"note"}],attrs:{placeholder:"选填,备注内容",eventid:"abfeaab4-1"},domProps:{value:t.note},on:{input:function(e){e.target.composing||(t.note=e.target.value)}}})])])]),a("view",{staticClass:"blck"}),a("view",{staticClass:"footer"},[a("view",{staticClass:"settlement"},[a("view",{staticClass:"sum"},[t._v("合计:"),a("view",{staticClass:"money"},[t._v("￥"+t._s(t.sumPrice))])]),a("view",{staticClass:"btn",attrs:{eventid:"abfeaab4-2"},on:{tap:t.toPay}},[t._v("提交订单")])])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"icon"},[a("image",{attrs:{src:"../../static/img/addricon.png",mode:""}})])}];a.d(e,"a",function(){return s}),a.d(e,"b",function(){return i})},c0a6:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i(a("bca8"));function i(t){return t&&t.__esModule?t:{default:t}}var n={components:{uniPopup:s.default},data:function(){return{addrMain:{contactName:"点击选择地址"},buylist:[],goodsPrice:0,sumPrice:0,freight:12,note:"",int:1200,deduction:0}},onShow:function(){var e=this;t.getStorage({key:"confirmAddr",success:function(t){e.addrMain=t.data}}),t.getStorage({key:"buylist",success:function(t){e.buylist=t.data,e.goodsPrice=0;for(var a=e.buylist.length,s=0;s<a;s++)e.goodsPrice=e.goodsPrice+e.buylist[s].stock*e.buylist[s].price;e.deduction=e.int/100,e.sumPrice=e.goodsPrice-e.deduction+e.freight,e.sumPrice=e.sumPrice.toFixed(2),e.goodsPrice=e.goodsPrice.toFixed(2),e.freight=e.freight.toFixed(2),e.deduction=e.deduction.toFixed(2)}})},onHide:function(){this.clearOrder()},onBackPress:function(){this.clearOrder()},methods:{changeAddr:function(){t.navigateTo({url:"../address/address"})},clearOrder:function(){t.removeStorage({key:"buylist",success:function(t){this.buylist=[],console.log("remove buylist success")}})},toPay:function(){var e=this;if(this.addrMain.contactPhone){for(var a=[],s=this.buylist.length,i=0;i<s;i++){var n={price:0,productId:1,productName:"string",quantity:1};n.price=this.buylist[i].price,n.productId=this.buylist[i].id,n.productName=this.buylist[i].name,n.quantity=this.buylist[i].stock,a.push(n)}t.request({url:this.$tempUrl+"buyer/order/create",method:"POST",data:{orderDetailBeans:a,remark:this.note,shopId:t.getStorageSync("shopId"),userAddress:this.addrMain.address,userName:this.addrMain.contactName,userPhone:this.addrMain.contactPhone,userWechatOpenid:t.getStorageSync("openId")},success:function(a){t.showLoading({title:"提交中..."}),setTimeout(function(){t.hideLoading(),e.payment(a.data.data.id)},500)}})}else t.showModal({title:"提交失败",content:"请选择收货地址",showCancel:!1})},payment:function(e){var a=this;t.showModal({title:"支付",content:"确认支付￥"+this.sumPrice,success:function(s){s.confirm?t.request({url:a.$tempUrl+"buyer/order/paid",method:"POST",data:{openId:t.getStorageSync("openId"),orderId:e},success:function(e){0===e.data.code?t.reLaunch({url:"../tabBar/user",success:function(){t.showToast({title:"支付成功",icon:"success"})}}):t.showModal({title:"提示",content:"订单异常，支付失败",showCancel:!1})}}):s.cancel&&t.reLaunch({url:"../tabBar/user",success:function(){t.showToast({title:"支付已取消，请尽快完成付款",icon:"none"})}})}})}}};e.default=n}).call(this,a("543d")["default"])},c45d:function(t,e,a){"use strict";a.r(e);var s=a("c0a6"),i=a.n(s);for(var n in s)"default"!==n&&function(t){a.d(e,t,function(){return s[t]})}(n);e["default"]=i.a},dbb0:function(t,e,a){"use strict";a("4436");var s=n(a("b0ce")),i=n(a("7ba1"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(i.default))},f8bf:function(t,e,a){"use strict";var s=a("8d43"),i=a.n(s);i.a}},[["dbb0","common/runtime","common/vendor"]]]);